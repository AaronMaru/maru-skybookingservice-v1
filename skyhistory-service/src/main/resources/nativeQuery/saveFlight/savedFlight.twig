SELECT
	fsave.id,
	fsave.trip_type AS tripType,
	fsave.class_name AS className,
	fsave.adult,
	fsave.child,
	fsave.infant,
	fsave.stop_search AS stopSearch,
	fsave.multiple_air_status AS multipleAirStatus,
	fsave.amount,
	fsave.currency_code AS currencyCode,
	fsave.decimal_places AS decimalPlaces

FROM flight_saves AS fsave
WHERE fsave.user_id = :skyuserId
AND fsave.status = 0
AND IF(:action = "search",
			fsave.trip_type LIKE '%' :keyword '%'
			OR fsave.class_name LIKE '%' :keyword '%'
			OR (
					SELECT COUNT(fsaveOD.id)
					FROM flight_save_origin_destinations fsaveOD
					WHERE fsaveOD.airline_name LIKE '%' :keyword '%'
					OR fsaveOD.o_location LIKE '%' :keyword '%'
					OR fsaveOD.d_location LIKE '%' :keyword '%'
					OR fsaveOD.o_location_name LIKE '%' :keyword '%'
					OR fsaveOD.d_location_name LIKE '%' :keyword '%'
				) > 0
		 , fsave.status = 0)

AND IF(:stake = 'skyuser',

			-- IF TRUE
			(fsave.user_id = :skyuserId AND fsave.company_id = 0)
			,

			-- IF FALSE
			-- Condition for Skyowner
			IF(:role = 'admin',
				  fsave.user_id = :skyuserId OR fsave.company_id = :companyId
				,
				   fsave.user_id = :skyuserId AND fsave.company_id = :companyId
			)

		) -- The end of if

ORDER BY fsave.id DESC